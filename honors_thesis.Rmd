---
title: "honors_thesis"
author: "Georges Ip"
date: "3/1/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Import libraries
library(lattice)
library(MASS)
library(car)
require(stats)
require(stats4)
library(KernSmooth)
library(cluster)
library(leaps)
library(mgcv)
library(rpart)
library(mgcv)
require("datasets")
require(graphics)
library(nlstools)
library(fpp)
library(fpp2)
library(strucchange)
library(Quandl)
library(zoo)
library(PerformanceAnalytics)
library(quantmod)
library(vars)
library(lmtest)
library(tseries)
library(dplyr)
library(lubridate)
library(TTR)
```

Main stock dataset
```{r}
#Using get.hist.quote
sp = get.hist.quote(instrument="^gspc", start="2009-01-01",
                              end="2018-12-31", quote=c("High", "Low", "Adjusted"),
                              provider="yahoo", origin="1970-01-01",
                              compression="d", retclass="zoo")
sp.data <- fortify.zoo(sp)
#using quantmod
sp500 <- new.env()
getSymbols("^GSPC", env = sp500, src = "yahoo", from = as.Date("2009-01-01"), to = as.Date("2019-12-31"))
GSPC <- sp500$GSPC
#Take first difference
sp.data <- sp.data %>%
  mutate(first.diff = Adjusted - lag(Adjusted))
#quantmod method
GSPC$diff <- GSPC$GSPC.Adjusted - Lag(GSPC$GSPC.Adjusted)
#Convert difference into output vector
sp.data <- sp.data %>% 
  mutate(direction = ifelse(sp.data$first.diff  > 0, 1, 0))
#quantmod method
GSPC$direction <- ifelse(GSPC$diff  > 0, 1, 0)
```

Technical Indicators (1)
```{r}
#implement a simple 10 day moving average
sp.data <- sp.data %>%
  mutate(sma10 = rollmean(Adjusted, k = 10, fill = NA, align = "right"))
#quantmod method
GSPC$SMA10 <- SMA(GSPC$GSPC.Adjusted, n = 10)
#implement a weighted 10 day moving average
sp.data <- sp.data %>%
  mutate(wma10 = WMA(Adjusted, n = 10, wts = 1:10))
#quantmod method
GSPC$WMA10 <- WMA(GSPC$GSPC.Adjusted, n = 10, wts = 1:10)
#Implement momentum, the amount the price has changed over the last n periods
momentum = diff(sp.data$Adjusted, lag = 4, differences = 1)
fill = rep(NA, 4)
momentum <- c(fill,momentum)
momentum.df <- data.frame(momentum, colnames = "momentum")
sp.data <- cbind(sp.data,momentum)
#quantmod method
momentum = diff(GSPC$GSPC.Adjusted, lag = 4, differences = 1)
GSPC$momentum <- momentum
#Implement stochastic K%, another indicator comparing the closing price of an asset to a range of its prices over a certain period of time n.
#We choose n = 14 for now
GSPC$stochastic.k <- stoch(GSPC[,c("GSPC.High","GSPC.Low", "GSPC.Adjusted")], nFastK = 14, bounded = TRUE)*100
#Implement stochastic D%, which is the 3-day mooving average of K%
GSPC$stochastic.d <- stoch(GSPC[,c("GSPC.High","GSPC.Low", "GSPC.Adjusted")],  nFastD = 3, bounded = TRUE)*100
#Implement RSI, the relative strength index. RSI is a measure of ratio of the recent upward price movements to the absolute price movement
#We will use n=14 for now
GSPC$RSI <- RSI(GSPC$GSPC.Adjusted, n = 14)
#Implement MACD, moving average convergence divergence. This is another oscillator indicator that utilizes exponential moving averages to chart thet trend of price movements 
GSPC$MACD <- MACD(GSPC[,"GSPC.Close"], 12, 26, 9, maType = "EMA")

```

Technical Indicators (2)
```{r}

```

Fundamental Indicators
```{r}

```

Sentiment Indicators
```{r}

```



